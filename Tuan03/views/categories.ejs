<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <title>Category Management</title>
    <link rel="shortcut icon" href="/images/logo.png" type="image/x-icon">
    <link rel="stylesheet" href="/stylesheets/style.css" />
</head>

<body>
    <div class="container">
        <div class="topbar">
            <div class="user-info">
                <h1>System Management</h1>
                <span class="badge">
                    üë§ <%= user.username %> (<%= user.role %>)
                </span>
            </div>
            <div class="nav-links">
                <a href="/" class="btn">Products</a>
                <a href="/categories" class="btn primary">Categories</a>
                <form action="/logout" method="post" style="display: inline;">
                    <button type="submit" class="btn danger">Logout</button>
                </form>
            </div>
        </div>

        <hr style="border: 0; border-top: 1px solid var(--border); margin-bottom: 20px;">
        
        <!-- Statistics Cards -->
        <div class="stats-grid" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));">
            <div class="stat-card">
                <div class="stat-icon" style="background: #dbeafe;">üìÅ</div>
                <div class="stat-content">
                    <div class="stat-label">Total Categories</div>
                    <div class="stat-value"><%= categories.length %></div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon" style="background: #dcfce7;">‚ú®</div>
                <div class="stat-content">
                    <div class="stat-label">Active Categories</div>
                    <div class="stat-value"><%= categories.length %></div>
                </div>
            </div>
        </div>

        <% if (user.role==='admin' ) { %>
            <h2 style="margin-top: 24px; margin-bottom: 16px;">‚ûï <%= editingCategory ? 'Edit Category' : 'Add New Category' %></h2>
            <div class="card">
                <form action="/categories/<%= editingCategory ? 'edit/' + editingCategory.categoryId : 'add' %>"
                    method="post">
                    <div>
                        <label>Category Name *</label>
                        <input type="text" name="name" placeholder="Enter category name" required
                            value="<%= editingCategory ? editingCategory.name : '' %>">
                    </div>
                    <div style="margin-top: 12px;">
                        <label>Description</label>
                        <textarea name="description"
                            placeholder="Enter description"><%= editingCategory ? editingCategory.description : '' %></textarea>
                    </div>
                    <button class="btn primary" type="submit" style="margin-top: 16px;">
                        <%= editingCategory ? 'Update Category' : 'Add Category' %>
                    </button>
                    <% if (editingCategory) { %>
                        <a href="/categories" class="btn" style="margin-left: 8px;">Cancel</a>
                        <% } %>
                </form>
            </div>
            <% } %>

                <h2 style="margin-top: 24px; margin-bottom: 16px;">üìã Categories List</h2>
                <div class="table-wrap">
                    <table>
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Description</th>
                                <% if (user.role==='admin' ) { %>
                                    <th>Actions</th>
                                    <% } %>
                            </tr>
                        </thead>
                        <tbody>
                            <% categories.forEach(cat=> { %>
                                <tr>
                                    <td>
                                        <%= cat.name %>
                                    </td>
                                    <td>
                                        <%= cat.description %>
                                    </td>
                                    <% if (user.role==='admin' ) { %>
                                        <td>
                                            <div class="action-buttons">
                                                <a href="/categories/edit/<%= cat.categoryId %>" class="btn">Edit</a>
                                                <form action="/categories/delete/<%= cat.categoryId %>" method="post"
                                                    style="display:inline">
                                                    <button class="btn danger"
                                                        onclick="return confirm('Are you sure you want to delete this category? Products will not be deleted.')">Delete</button>
                                                </form>
                                            </div>
                                        </td>
                                        <% } %>
                                </tr>
                                <% }) %>
                        </tbody>
                    </table>
                </div>
    </div>
</body>

</html>